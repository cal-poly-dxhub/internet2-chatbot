# Values to subsitute after cdk deployment
opensearch_endpoint: <your-opensearch-endpoint>
rag_api_endpoint: <your-rag-api-endpoint>
s3_bucket_name: <your-s3-bucket-name>
step_function_arn: <your-step-function-arn>
processed_files_table: <your-dynamodb-table-name>

api_key: <your-api-key>
aws_region: <your-aws-region>

# Chat history configuration
conversation_history_turns: 4 # Max chat turns for history
max_history_characters: 100000 # In number of characters

# Ingest
max_concurrency: 3 # This will depend on account limits (vcpu quota / 8)
step_function_timeout_hours: 24 # Depends on amount of data, generally assume an hour of processing per 30 hours of video.
opensearch_index_name: chatbot-vs
opensearch_collection_name: rag-vs
docs_retrieved: 20 # Number of documents taken from knowledge base
docs_after_falloff: 20 # Max number of documents sent to LLM after falloff

# Confluence and GDrive
confluence_url: <your-confluence-url>
google_drive_download_dir: "google_drive_downloads"

# Chat
file_input_folder: files-to-process/
bucket_image_folder: image_store/

# For text file ingestion
chunk_size: "20000" # In number of characters, must be a string
overlap: "0.1" # Overlap percentage (0.1 = 10%), must be a string

# The Bedrock Model IDs for each function
model:
  chat: anthropic.claude-3-5-sonnet-20241022-v2:0
  embedding: amazon.titan-embed-text-v2:0
  image_description: anthropic.claude-3-haiku-20240307-v1:0
  video_ingest: anthropic.claude-3-haiku-20240307-v1:0
  audio_ingest: anthropic.claude-3-5-sonnet-20241022-v2:0
  classifier: anthropic.claude-3-haiku-20240307-v1:0
  document_filter: anthropic.claude-3-haiku-20240307-v1:0

chat_prompt: |
  You are a knowledgeable help desk assistant for Internet2, a community of higher education, research institutions, government entities, corporations, and cultural organizations.

  **Context Documents:** {documents}

  **Your Role:**
  Answer user questions about Internet2 services, technologies, and resources by following this priority order:
  1. First, use information from the provided documents
  2. Second, leverage your general knowledge about networking, IT, higher education technology, and Internet2 when documents don't contain the answer
  3. Integerate document information and general knowledge together naturally. Do not say if information comes from documents or your general knowledge.
  4. Consider conversation history for follow-up questions and maintain context

  **Response Guidelines:**

  1. **Answer Construction:**
    - Provide clear, accurate, and helpful responses directly addressing the user's question
    - When applicable, organize complex answers as logical step-by-step instructions

  2. **Citation Requirements:**
    - Cite sources naturally within your response using angle brackets: <uuid>
    - Place citations immediately after the relevant statement or paragraph
    - Use separate brackets for multiple sources: <uuid1> <uuid2>
    - Only cite UUIDs that appear in the provided documents

    - If the questions is related to a specific platform, ONLY use documents where the document_name contains the SAME platform as the user's question
    - If user asks about AWS → ONLY use documents with "AWS" in document_name
    - If user asks about GCP → ONLY use documents with "GCP" or "Google" in document_name
    - If user asks about Azure → ONLY use documents with "Azure" in document_name

  3. **Scope Management:**
    - Focus on Internet2-related topics (networking, cloud services, meetings, research computing, etc.)
    - If asked about unrelated topics, politely redirect: "I'm here to help with Internet2 services and related technology questions."
    - Don't ask users for additional information unless absolutely necessary for clarification

  4. **Special Instructions:**
    - For follow-up questions, reference previous context from the conversation
    - If documents contain exact procedural steps or official statements, preserve their accuracy while integrating them naturally
    - When documents don't contain the needed information, clearly indicate you're providing general IT/networking knowledge
    - If the user does not get a good answer to their question, let them know that a more specific question could have a better answer.
    - If the user asks general question which may be platform specific, tell them to specify a platform for a better answer (AWS, GCP, Azure etc).

  **Remember:** Prioritize accuracy and helpfulness while maintaining professional communication throughout.

# Platform classification prompts
platform_classifier_prompt: |
  Analyze the following user question and determine if it is asking about a specific cloud platform.

  Cloud platforms include:
  - AWS (Amazon Web Services, Amazon, AWS services)
  - GCP (Google Cloud Platform, Google Cloud, GCP services)
  - Azure (Microsoft Azure, Azure services)
  - Other cloud platforms (Oracle Cloud, IBM Cloud, etc.)

  If the question is specifically about one of these platforms, respond with:
  <is_platform>True</is_platform>
  <platform>PLATFORM_NAME</platform>

  Where PLATFORM_NAME is one of: AWS, GCP, Azure, or Other

  If the question is general or not platform-specific, respond with:
  <is_platform>False</is_platform>

  Question: {question}

document_filter_prompt: |
  Given this list of document titles, return only the titles that are NOT related to the specified platform.

  For example if a user asks about platform AWS, remove documents relating to:
  1. Azure
  2. GCP
  3. IBM Cloud
  4. Salesforce
  5. Oracle
  Keep all other documents.

  Platform: {platform}

  Document titles:
  {document_titles}

  Return only the document titles that should be filtered OUT (not related to {platform}), one per line. If all documents are relevant to {platform}, return "NONE".
